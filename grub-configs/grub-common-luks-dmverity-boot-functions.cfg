function boot_linux {
	insmod part_gpt
	insmod part_msdos
	insmod ext2
	if [ "$tpm" = "true" ] ; then
		echo "Will measure GRUB in TPM PCR #8"
		insmod tpm
	fi

	if [ -z "$rd_systemd_shell_options" ] ; then
		rd_systemd_shell_options="rd.shell SYSTEMD_SULOGIN_FORCE=1"
	fi

	set root='hd0,1'

	linux /boot/bzImage.signed ro $console $rd_systemd_shell_options \
	root=@@KERNEL_CMDLINE_ROOT@@ \
	rd.luks.name=@@UUID_ROOTFS_ENC_IMG@@=@@LUKS_MAPPER_NAME@@ \
	systemd.verity_root_data=/dev/mapper/@@LUKS_MAPPER_NAME@@ \
	systemd.verity_root_hash=UUID=@@UUID_DMVERITY_ROOTFS_HASH_IMG@@ \
	roothash=@@DMVERITY_ROOT_HASH@@

	initrd /boot/initrd.img
}

